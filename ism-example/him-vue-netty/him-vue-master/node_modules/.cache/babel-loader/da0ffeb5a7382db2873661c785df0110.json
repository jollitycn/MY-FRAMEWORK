{"remainingRequest":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\thread-loader\\dist\\cjs.js!D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\babel-loader\\lib\\index.js!D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\src\\views\\Home.vue","mtime":1560643907000},{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1578480813089},{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1578480813089},{"path":"D:\\ProjectData\\github\\him-vue-netty\\him-vue-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.typed.uint8-array\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Cookies from \"js-cookie\"; // protobuf 编码\n\nimport protoRoot from \"@/proto/proto\";\nimport Him from \"../components/Him/index\";\nvar WSBaseReqProto = protoRoot.lookup(\"protocol.WSBaseReqProto\");\nvar WSBaseResProto = protoRoot.lookup(\"protocol.WSBaseResProto\");\nexport default {\n  name: \"home\",\n  data: function data() {\n    var qqRedirectUri = \"http://him-netty.await.fun/h5\";\n    var client_id = \"101574853\";\n    return {\n      errLog: \"\",\n      isShow: false,\n      qqRedirectUri: qqRedirectUri,\n      qqLoginUrl: \"https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=\" + client_id + \"&redirect_uri=\" + encodeURIComponent(qqRedirectUri) + \"&state=1\",\n      userCheckCode: null,\n      groupCheckCode: null,\n      apiBaseUrl: process.env.VUE_APP_API_BASE,\n      webSocketUrl: process.env.VUE_APP_WEBSOCKET_URL,\n      userQRCodeUrl: process.env.VUE_APP_USER_QR_CODE_URL,\n      groupQRCodeUrl: process.env.VUE_APP_GROUP_QR_CODE_URL\n    };\n  },\n  components: {\n    Him: Him\n  },\n  methods: {\n    // WebSocket 编码\n    WSResEncode: function WSResEncode(payload) {\n      var errMsg = WSBaseReqProto.verify(payload);\n      console.log(\"buff 解析错误信息：\", errMsg); // Create a new message\n\n      var wsData = WSBaseReqProto.create(payload); // Encode a message to an Uint8Array (browser) or Buffer (node)\n\n      return WSBaseReqProto.encode(wsData).finish();\n    },\n    // WebSocket 编码\n    WSResDecode: function WSResDecode(data, cb) {\n      var reader = new FileReader();\n      reader.readAsArrayBuffer(data);\n\n      reader.onload = function () {\n        var buf = new Uint8Array(reader.result);\n        var response = WSBaseResProto.decode(buf);\n        cb(response);\n      };\n    },\n    // 点击了QQ登录\n    qqLoginClick: function qqLoginClick() {\n      // 前去授权\n      window.location.href = this.qqLoginUrl;\n    },\n    isShowClick: function isShowClick() {\n      this.isShow = !this.isShow;\n    },\n    // 登录初始化完成\n    loginInit: function loginInit() {\n      var _this = this;\n\n      var userCheckCode = this.getUserCheckCode();\n      var groupCheckCode = this.getGroupCheckCode();\n      console.log(\"登录初始化完成\", userCheckCode, groupCheckCode); // 如果有加朋友的验证码\n\n      if (userCheckCode) {\n        // 发送加好友的请求\n        this.$refs[\"him\"].createUserFriendAsk(userCheckCode); // 发送后删除\n\n        this.delUserCheckCode();\n        this.$router.push(\"/\");\n      } // 如果有加群的验证码\n\n\n      if (groupCheckCode) {\n        this.$refs[\"him\"].joinGroupUser(groupCheckCode); // 发送后删除\n\n        this.delGroupCheckCode();\n        this.$router.push(\"/\");\n      } // 登录成功, 延时显示聊天界面\n\n\n      setTimeout(function () {\n        _this.isShow = true;\n      }, 1000);\n    },\n    requestErr: function requestErr(code, message) {\n      var text = \"接口报错: code: \" + code + \", message:\" + message;\n      this.errLog = text + \"\\n\" + this.errLog;\n    },\n    getQueryVariable: function getQueryVariable(variable) {\n      var query = window.location.search.substring(1);\n      var vars = query.split(\"&\");\n\n      for (var i = 0; i < vars.length; i++) {\n        var pair = vars[i].split(\"=\");\n\n        if (pair[0] === variable) {\n          return pair[1];\n        }\n      }\n\n      return false;\n    },\n    setUserCheckCode: function setUserCheckCode(value) {\n      Cookies.set(\"USER_CHECK_CODE\", value, {\n        expires: 1,\n        path: \"/\"\n      });\n    },\n    getUserCheckCode: function getUserCheckCode() {\n      return Cookies.get(\"USER_CHECK_CODE\", {\n        path: \"/\"\n      });\n    },\n    delUserCheckCode: function delUserCheckCode() {\n      return Cookies.remove(\"USER_CHECK_CODE\", {\n        path: \"/\"\n      });\n    },\n    setGroupCheckCode: function setGroupCheckCode(value) {\n      Cookies.set(\"GROUP_CHECK_CODE\", value, {\n        expires: 1,\n        path: \"/\"\n      });\n    },\n    getGroupCheckCode: function getGroupCheckCode() {\n      return Cookies.get(\"GROUP_CHECK_CODE\", {\n        path: \"/\"\n      });\n    },\n    delGroupCheckCode: function delGroupCheckCode() {\n      return Cookies.remove(\"GROUP_CHECK_CODE\", {\n        path: \"/\"\n      });\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    // 授权成功后的跳转\n    this.code = this.getQueryVariable(\"code\"); // QQ 登录的code码\n\n    if (this.code) {\n      this.$refs[\"him\"].qqLogin(this.code, this.qqRedirectUri); // 清空浏览器地址栏的值, 这里其实是刷新当前页面\n\n      this.$router.push(\"/\");\n    } // 默认打开, 延时显示聊天界面\n\n\n    setTimeout(function () {\n      _this2.isShow = true;\n    }, 500);\n  },\n  created: function created() {\n    // 获取get参数\n    var userCheckCode = this.getQueryVariable(\"userCheckCode\"); // 判断是否和 Cookie 里面的值相同\n\n    if (userCheckCode && userCheckCode !== \"\" && userCheckCode !== this.getUserCheckCode()) {\n      this.setUserCheckCode(userCheckCode);\n    }\n\n    var groupCheckCode = this.getQueryVariable(\"groupCheckCode\"); // 判断是否和 Cookie 里面的值相同\n\n    if (groupCheckCode && groupCheckCode !== \"\" && groupCheckCode !== this.getGroupCheckCode()) {\n      this.setGroupCheckCode(groupCheckCode);\n    }\n  }\n};",{"version":3,"sources":["Home.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n        <!--错误信息方便调试-->\n        <div class=\"errlog-box\" v-if=\"errLog.length > 0\">\n\n            <textarea id=\"errlog\" v-model=\"errLog\">\n\n        </textarea>\n        </div>\n        <div class=\"text\" :class=\"{'is-show': isShow}\">\n            <h1 class=\"title\" style=\"font-size: 18px;\">一篇文章引发的<span style=\"color: red;\">思考</span></h1>\n            <div class=\"content\">\n                一次读公号推文, 发现一篇文章写得特好, 勾起了好奇心\n                <h2 style=\"margin-top: 20px;\"><a target=\"_blank\" href=\"https://mp.weixin.qq.com/s/so7F88S7-3Wmq9x_rrYAoA\">《群聊比单聊，为什么复杂这么多？》</a></h2>\n                <h5><cite style=\"color: rgb(0, 82, 255)\">( 画外音: 点击查看详情 )</cite> </h5>\n                <h3 style=\"margin-top: 10px;\">从此无法自拔</h3>\n                <div style=\"color: #99a9bf\">于是有了下面的故事</div>\n                <h3 style=\"margin-top: 20px;\">开源的H5聊天系统 </h3>\n                <h5><cite style=\"color: rgb(0, 82, 255)\">( 画外音: 开源爱好者😝 )</cite> </h5>\n                <div style=\"color: #99a9bf\">注: 你会发现这个系统是适配手机端和PC端的</div>\n                <h5 style=\"margin-top: 20px;\"><span>( 地址 )</span> </h5>\n                <div style=\"margin-top: 10px;\">\n                    <a href=\"https://github.com/lmxdawn/him-vue\" style=\"margin-left: 2px;font-size: 25px;\">him-vue</a>\n                    <a href=\"https://github.com/lmxdawn/him-netty\" style=\"margin-left: 2px;font-size: 25px;\">him-netty</a>\n                    <a href=\"https://shang.qq.com/wpa/qunwpa?idkey=d4965fc7101936dcdea5eb1d05e2eaeb3128f20796028ee937ab516652083c6c\" style=\"margin-left: 2px;font-size: 25px;\">QQ群</a>\n                </div>\n\n                <h3 style=\"color: red;margin-top: 10px;\">点击右下角 ﹤我们开始聊天吧~﹥ 按钮</h3>\n\n                <h3 style=\"margin-top: 20px;\">操作流程</h3>\n                <h4 style=\"color: green\">\n                    <br/>\n                    点击右下方的我们聊天吧\n                    <br/>\n                    <span style=\"font-size: 20px;\">↓</span>\n                    <br/>\n                    女游客/男游客/QQ登录\n                    <br/>\n                    <span style=\"font-size: 20px;\">↓</span>\n                    <br/>\n                    点击右上方的 二维码按钮, 生成二维码 <span style=\"color: red;\">注意: 建议在浏览器中测试, 因为反复测试, 在iOS手机版的QQ中退出登录会失败, 因为Cookie清空不了</span>\n                    <br/>\n                    <span style=\"font-size: 20px;\">↓</span>\n                    <br/>\n                    把生成好的二维码发给好友\n                    <br/>\n                    <span style=\"font-size: 20px;\">↓</span>\n                    <br/>\n                    这个时候等待好友确认, 就可以聊天了\n                    <br/>\n                    <span style=\"font-size: 20px;\">↓</span>\n                    <br/>\n                    左下角 换肤图标 可以切换皮肤\n\n                </h4>\n\n                <h1 style=\"color: red;margin-top: 10px;\">已知的问题列表</h1>\n\n                <div class=\"wenti-list\">\n                    <div style=\"margin-top: 5px\">1. iOS版本手机QQ中清空不了 Cookie 的bug (Android 版本的QQ没试), 其它浏览器均正常</div>\n                    <div style=\"margin-top: 5px;\">\n                        2. 手机微信中打开后点击输入文字后, 不管点不点击发送按钮都会出现短暂的不能点击的现象(任何按钮都不能点击), 后来发现是因为在微信里面, 输入法把 输入框顶上去了, 然后输入法隐藏后输入框还在上面!!!!\n                        <a target=\"_blank\" href=\"https://developers.weixin.qq.com/community/develop/doc/00040a43cd4290dedbc7e7f1851400\">点击查看详情</a>\n                    </div>\n                </div>\n\n                <h1>功能列表</h1>\n                <div class=\"gongneng-list\">\n                    <div><label><input type=\"checkbox\" disabled checked />单聊</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />群聊</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />protobuf 编解码</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />客户端心跳</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />客户端断开重连</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />异地登录, 通知下线</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />移动端/PC端适配</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />离线消息 (ack 机制, 实现可达性)</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />第三方QQ登录</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />自带 emoji 表情</label></div>\n                    <div><label><input type=\"checkbox\" disabled checked />文本消息</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>声音提示</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>图片消息</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>音频消息</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>视屏消息</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>分布式部署</label></div>\n                    <div><label><input type=\"checkbox\" disabled/>PHP 版本的 (Workerman 版本)</label></div>\n                </div>\n\n            </div>\n\n            <h2 style=\"margin-top: 20px;\">效果图</h2>\n\n            <div class=\"img-list\">\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG15.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG16.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG17.jpeg'/>\n                </div>\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG18.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG19.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG20.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG21.jpeg'/>\n                </div>\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG22.jpeg'/>\n                </div>\n\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/1WechatIMG24.jpeg'/>\n                </div>\n\n\n\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG6.jpeg'/>\n                </div>\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG7.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG8.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG9.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG10.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG11.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG12.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG13.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG14.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG15.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG16.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG17.jpeg'/>\n                </div>\n\n\n                <div class=\"img-list-item\">\n                    <img src='https://github.com/lmxdawn/him-vue/raw/master/pic/WechatIMG18.jpeg'/>\n                </div>\n\n            </div>\n\n        </div>\n\n        <div class=\"view-box\">\n            <him ref=\"him\"\n                :isShow=\"isShow\"\n                width=\"350px\"\n                height=\"650px\"\n                bottom=\"0\"\n                right=\"0\"\n                :apiBaseUrl=\"apiBaseUrl\"\n                :webSocketUrl=\"webSocketUrl\"\n                :userQRCodeUrl=\"userQRCodeUrl\"\n                :groupQRCodeUrl=\"groupQRCodeUrl\"\n                :WSResEncode=\"WSResEncode\"\n                :WSResDecode=\"WSResDecode\"\n                @on-is-show-click=\"isShowClick\"\n                @on-qq-login-click=\"qqLoginClick\"\n                @on-login-init=\"loginInit\"\n                @on-request-err=\"requestErr\">\n\n            </him>\n        </div>\n        <div class=\"btn-ok\" @click=\"isShowClick\" v-if=\"!isShow\">\n            <i class=\"icon\"></i>\n            <span class=\"text\">我们聊天吧~</span>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Cookies from \"js-cookie\";\n// protobuf 编码\nimport protoRoot from \"@/proto/proto\";\nimport Him from \"../components/Him/index\";\n\nconst WSBaseReqProto = protoRoot.lookup(\"protocol.WSBaseReqProto\");\nconst WSBaseResProto = protoRoot.lookup(\"protocol.WSBaseResProto\");\n\nexport default {\n    name: \"home\",\n\n    data() {\n        const qqRedirectUri = \"http://him-netty.await.fun/h5\";\n        const client_id = \"101574853\";\n        return {\n            errLog: \"\",\n            isShow: false,\n            qqRedirectUri: qqRedirectUri,\n            qqLoginUrl:\n                \"https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=\" +\n                client_id +\n                \"&redirect_uri=\" +\n                encodeURIComponent(qqRedirectUri) +\n                \"&state=1\",\n            userCheckCode: null,\n            groupCheckCode: null,\n            apiBaseUrl: process.env.VUE_APP_API_BASE,\n            webSocketUrl: process.env.VUE_APP_WEBSOCKET_URL,\n            userQRCodeUrl: process.env.VUE_APP_USER_QR_CODE_URL,\n            groupQRCodeUrl: process.env.VUE_APP_GROUP_QR_CODE_URL\n        };\n    },\n    components: {\n        Him\n    },\n    methods: {\n        // WebSocket 编码\n        WSResEncode(payload) {\n            let errMsg = WSBaseReqProto.verify(payload);\n            console.log(\"buff 解析错误信息：\", errMsg);\n            // Create a new message\n            const wsData = WSBaseReqProto.create(payload);\n            // Encode a message to an Uint8Array (browser) or Buffer (node)\n            return WSBaseReqProto.encode(wsData).finish();\n        },\n        // WebSocket 编码\n        WSResDecode(data, cb) {\n            let reader = new FileReader();\n            reader.readAsArrayBuffer(data);\n            reader.onload = () => {\n                const buf = new Uint8Array(reader.result);\n                const response = WSBaseResProto.decode(buf);\n                cb(response);\n            };\n        },\n        // 点击了QQ登录\n        qqLoginClick() {\n            // 前去授权\n            window.location.href = this.qqLoginUrl;\n        },\n        isShowClick() {\n            this.isShow = !this.isShow;\n        },\n        // 登录初始化完成\n        loginInit() {\n            let userCheckCode = this.getUserCheckCode();\n            let groupCheckCode = this.getGroupCheckCode();\n            console.log(\"登录初始化完成\", userCheckCode, groupCheckCode);\n            // 如果有加朋友的验证码\n            if (userCheckCode) {\n                // 发送加好友的请求\n                this.$refs[\"him\"].createUserFriendAsk(userCheckCode);\n                // 发送后删除\n                this.delUserCheckCode();\n                this.$router.push(\"/\");\n            }\n            // 如果有加群的验证码\n            if (groupCheckCode) {\n                this.$refs[\"him\"].joinGroupUser(groupCheckCode);\n                // 发送后删除\n                this.delGroupCheckCode();\n                this.$router.push(\"/\");\n            }\n            // 登录成功, 延时显示聊天界面\n            setTimeout(() => {\n                this.isShow = true;\n            }, 1000);\n        },\n        requestErr(code, message) {\n            let text = \"接口报错: code: \" + code + \", message:\" + message;\n            this.errLog = text + \"\\n\" + this.errLog;\n        },\n        getQueryVariable(variable) {\n            var query = window.location.search.substring(1);\n            var vars = query.split(\"&\");\n            for (var i = 0; i < vars.length; i++) {\n                var pair = vars[i].split(\"=\");\n                if (pair[0] === variable) {\n                    return pair[1];\n                }\n            }\n            return false;\n        },\n        setUserCheckCode(value) {\n            Cookies.set(\"USER_CHECK_CODE\", value, {\n                expires: 1,\n                path: \"/\"\n            });\n        },\n        getUserCheckCode() {\n            return Cookies.get(\"USER_CHECK_CODE\", {\n                path: \"/\"\n            });\n        },\n        delUserCheckCode() {\n            return Cookies.remove(\"USER_CHECK_CODE\", {\n                path: \"/\"\n            });\n        },\n        setGroupCheckCode(value) {\n            Cookies.set(\"GROUP_CHECK_CODE\", value, {\n                expires: 1,\n                path: \"/\"\n            });\n        },\n        getGroupCheckCode() {\n            return Cookies.get(\"GROUP_CHECK_CODE\", {\n                path: \"/\"\n            });\n        },\n        delGroupCheckCode() {\n            return Cookies.remove(\"GROUP_CHECK_CODE\", {\n                path: \"/\"\n            });\n        }\n    },\n    mounted() {\n        // 授权成功后的跳转\n        this.code = this.getQueryVariable(\"code\"); // QQ 登录的code码\n        if (this.code) {\n            this.$refs[\"him\"].qqLogin(this.code, this.qqRedirectUri);\n            // 清空浏览器地址栏的值, 这里其实是刷新当前页面\n            this.$router.push(\"/\");\n        }\n        // 默认打开, 延时显示聊天界面\n        setTimeout(() => {\n            this.isShow = true;\n        }, 500);\n    },\n    created() {\n        // 获取get参数\n        let userCheckCode = this.getQueryVariable(\"userCheckCode\");\n        // 判断是否和 Cookie 里面的值相同\n        if (\n            userCheckCode &&\n            userCheckCode !== \"\" &&\n            userCheckCode !== this.getUserCheckCode()\n        ) {\n            this.setUserCheckCode(userCheckCode);\n        }\n        let groupCheckCode = this.getQueryVariable(\"groupCheckCode\");\n        // 判断是否和 Cookie 里面的值相同\n        if (\n            groupCheckCode &&\n            groupCheckCode !== \"\" &&\n            groupCheckCode !== this.getGroupCheckCode()\n        ) {\n            this.setGroupCheckCode(groupCheckCode);\n        }\n    }\n};\n</script>\n\n<style type=\"text/scss\" lang=\"scss\">\n.btn-ok {\n    position: fixed;\n    right: 30px;\n    bottom: 30px;\n    width: auto;\n    padding: 20px 30px;\n    cursor: pointer;\n    border-radius: 33px;\n    background-color: #6ed0ce;\n    color: #ffffff;\n    box-shadow: 7px 7px 12px 4px rgba(2, 25, 25, 0.05);\n    text-align: center;\n    .icon {\n        vertical-align: middle;\n        width: 20px;\n        height: 20px;\n        display: inline-block;\n        margin-right: 10px;\n        background-size: 100%;\n        background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAhCAYAAAC4JqlRAAAAAXNSR0IArs4c6QAAA51JREFUWAm1l39ojVEYx3e3NWPMZsMWoazsnyn/KC1MSf6Z/GFpIhGapESRaBLlR0Ki/Ig0tVAo2/IjpOYPIo0ls1mT+TVpzNbMjzaf73bOOnbv3vveu+upz32e85znec553/ec8743EBeh9PT0JJOSB1mQAW3QArWBQKAdHXth0AQohhvQCaHkN85qWA/DYzYLii2CBnDlD42PUAvN8Atc+Uxj3ZAmQYEkOOlU7cI+AwvhnyuknQhz4BC0gZUqjLSIJ0KSBq+0VdAXYcLAQvjiQ/jS8B+BbpA8hcyBcZ5tEi4rE9GtXmuDsQvgBDwDe6Ud2HVwFvS4EhSP1p1Sn+QxJNk6nprANcpAdAUrTDENrEH9SBNBS0zeXGy7aI95DmwSMkloB8lh49vR14z4V+slHkpMpi5ohuckCNhjghvRybDXtKNVF0jUAr1nClQNOgET2GoCNeudxh6qKqPAPKfI5JCTIGC2CdIzywVtu1hJEYVemWJbgiZAxxgoNwG3HNu4fCtNviZEtB6pdo9EO0Pnw7TeiWBkwzuwUo9h97D1+dWa/CSwW9TNU11XXtNI0H4tdb1DtJfqqqix3WedXJ1kQSdc762J/Oc4b8NLJu0o+ouPEilBR6mPJDeki8YdKGDwjbYD+wd2mW176USvzgF9nbRfwHOogUfSDPYbHUrKcW4O1eH6/ExAt3I1VDFYt5scxtZEf8Iwrzg/j6CIgSsiHDzO3Jk6r8Hp69YEWjyCmih036M/XNc3jwCtk0ZN4Dx8ByvN1kD7WclOeJCpdWOlFKPJNDrQxVxc37js2Smgt94GGAUPQPLWZkejyX/YW6Xvs00vpRTQEb/Lsx4B88FKumewRycFPpkiqxSGXWjaszzS+roIPG2Cl7vB+LIg4Ppk40uFqdaPnQ+SSsen17K+nvoXf1AhJ3gEdjVo683kefWoj+QclI7cetAi0/+EbNDgB4hrRSvuKkqn7AJ8ejcsxr4GK2mXocMLSenwBLSA+oV2HuyDU4Zt6P4jHXsT3ITRSkLnwFe4DYNedP8ArkFCMhyEEtcvG18GjHT9tPV2dT9kp9N+D29gvBv7X20G0+f5ftA3gp77xJgNSLGxoM9w3dJlbmHa42Ar2M87xaW6MUO2KXgFrOjjRf+IzoHWi9qiAvLDDRbZgjDVKNyAqd1gRS+dRngJd6GSle6eqLhiKExgN1jRH1Ftw6gkqjugkRi0EKWtd52r/SBfNPIXcYb3XT9WZh4AAAAASUVORK5CYII=\");\n    }\n    .text {\n        vertical-align: middle;\n        line-height: 20px;\n    }\n}\n.view-box {\n    width: 100%;\n}\n.text {\n    margin-top: 10px;\n    text-align: center;\n    .content {\n        /*text-align: left;*/\n        margin-top: 20px;\n    }\n}\n.img-list {\n    padding-left: 80px;\n    padding-right: 80px;\n    text-align: left;\n    .img-list-item {\n        display: inline-block;\n        padding: 20px;\n        width: 50%;\n        vertical-align: top;\n        img {\n            width: 100%;\n        }\n    }\n}\n.wenti-list {\n    width: 800px;\n    margin: 0 auto;\n    text-align: left;\n}\n.gongneng-list {\n    width: 300px;\n    margin: 0 auto;\n    text-align: left;\n    input {\n        -webkit-appearance: checkbox;\n        -moz-appearance: checkbox;\n        appearance: checkbox;\n        margin-right: 5px;\n    }\n}\n.errlog-box {\n    width: 400px;\n    margin: 0 auto;\n    height: 300px;\n    color: red;\n    textarea {\n        width: 100%;\n        height: 100%;\n    }\n}\n@media screen and (max-width: 768px) {\n    .errlog-box {\n        width: 100%;\n    }\n    .wenti-list {\n        width: 85%;\n    }\n    .gongneng-list {\n        width: 80%;\n    }\n    .img-list {\n        padding-left: 0;\n        padding-right: 0;\n        .img-list-item {\n            width: 100%;\n        }\n    }\n    /*手机端隐藏背后*/\n    .is-show {\n        display: none;\n    }\n}\n</style>\n"],"sourceRoot":"src\\views"}]}