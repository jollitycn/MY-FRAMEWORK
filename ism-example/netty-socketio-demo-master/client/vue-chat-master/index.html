<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="jollitycn,聊天室,Vue,Socket.io,JavaScript,ES6,Vue.js,HTML5,Koa">
    <meta name="description" content="Vue 聊天室 Socket.io jollitycn JavaScript ES6 Vue.js HTML5 Koa jollitycn">
    <title>智能聊天室 Vue Chat Powered by jollitycn.com</title>
  </head>
  <body>
    <div id="app"></div>
     built files will be auto injected
    <script src="./static/js/socket.io.js"></script>
    <script>
      //const socket = io.connect('ws://jollitycn.com:9092');
      //const socket =  io.connect('http://localhost:9099');
      var userName = "test1";
      const socket = io.connect('http://jollitycn.com:9099?username=test1&password=123456');
    // const socket = io.connect('ws://192.168.199.106:9092');
    //  var socket =  io.connect('http://localhost:9099');
      socket.on('connect', function() {
        output('<span class="connect-msg">Client has connected to the server!</span>');
      });

      socket.on('chatevent', function(data) {
        output('<span class="username-msg">' + data.userName + ':</span> ' + data.message);
      });

      socket.on('disconnect', function() {
        output('<span class="disconnect-msg">The client has disconnected!</span>');
      });

      function sendDisconnect() {
        socket.disconnect();
      }

      function sendMessage() {
        var message = $('#msg').val();
        $('#msg').val('');
        var jsonObject = {userName: userName,
          message: message};
        socket.emit('chatevent', jsonObject);
      }

      function output(message) {
        var currentTime = "<span class='time'>" +  moment().format('HH:mm:ss.SSS') + "</span>";
        var element = $("<div>" + currentTime + " " + message + "</div>");
        $('#console').prepend(element);
      }

      $(document).keydown(function(e){
        if(e.keyCode == 13) {
          $('#send').click();
        }
      });
    </script>

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ce268e8f61069a1636a4629acbb82b9a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
